# シンペイ（SIMPEI）ゲーム仕様書
## 1. 基本概要
- プレイヤー数：2人（先手・後手）
- 各プレイヤーは 4つの駒 を持つ（色：赤と青）
- 盤面は 2つのレイヤ（世界） で構成される
- 上の世界（4×4 = 16マス）
- 下の世界（3×3 = 9マス）
- 合計 25 マス
      1   2   3   4   5   6   7
    +---+---+---+---+---+---+---+
A   | □ |   | □ |   | □ |   | □ |
    +---+---+---+---+---+---+---+
B   |   | ■ |   | ■ |   | ■ |   |
    +---+---+---+---+---+---+---+
C   | □ |   | □ |   | □ |   | □ |
    +---+---+---+---+---+---+---+
D   |   | ■ |   | ■ |   | ■ |   |
    +---+---+---+---+---+---+---+
E   | □ |   | □ |   | □ |   | □ |
    +---+---+---+---+---+---+---+
F   |   | ■ |   | ■ |   | ■ |   |
    +---+---+---+---+---+---+---+
G   | □ |   | □ |   | □ |   | □ |
    +---+---+---+---+---+---+---+
- 上の世界：
    A1, A3, A5, A7
    C1, C3, C5, C7
    E1, E3, E5, E7
    G1, G3, G5, G7
- 下の世界：
    B2, B4, B6
    D2, D4, D6
    F2, F4, F6

## 2. 勝利条件
- 同じ世界（上 or 下）で、自分の駒を 3つ一直線（縦・横・斜め）に並べたら勝利
- 4つ並べても勝利条件にはならない（3つのみ）
- 上下混合での 3 連は無効
- 自分の手番の行動により成立した場合のみ勝利とみなす→ 相手の「飛ばし」で偶然揃った場合は勝利にならない

## 3. ゲームフェーズ
- ゲームは次の2フェーズで進行する。
### フェーズ1：配置フェーズ
- プレイヤーは手持ちの駒を空きマスへ交互に配置する
- 最初の一手のみ：上の世界の中央 4 マスのいずれかに置く必要がある
- それ以降（2手目〜8手目）は：任意の空きマスに置ける
- 合計8手（各4駒）置いたらフェーズ終了
- このフェーズでは「駒の移動」は不可

### フェーズ2：移動フェーズ
- 各ターン、自分の駒を 別の世界へ 1マス移動させる
- 上 → 下
- 下 → 上
- 移動先は「対応する世界の空きマス」ならどこでも良い（隣接条件なし）
- 動かせる駒がない場合、そのターンは「パス」
- 両者連続で動けない場合は引き分けまたはゲーム終了（後で仕様選択可能）

## 4. 挟み（サンド）ルール
- 同じ世界で、相手の駒を 自分の2駒で一直線に挟んだ場合、「挟み」が成立する
- 挟んだ相手駒は 任意の空きマスへ飛ばすことができる
- 複数同時に挟んだ場合、それらすべてを飛ばす
- 飛ばしは必ず実行する（飛ばさない選択は不可）
- 飛ばし後に相手の連続が成立しても勝利にはならない

## 5. 手番の流れ（移動フェーズ）
- 駒を1つ選択する
- その駒を「反対側の世界」の空きマスへ移動させる
- 挟みが発生していれば、対象の駒を任意の空きマスへ移動させる

### 勝利判定
- ターン終了し相手に手番が移る

## 6. 禁止行為・ルール補足
- 自分の駒を同一世界内で移動することは不可（必ず上下移動）
- 駒の重ね置き不可
- 盤外・無効マスへの移動不可
- 飛ばし先は「空きマス」であれば上下どちらでも良い

## 7. ゲーム終了条件
- 勝利条件成立 → 即終了
- 双方が連続でパス → 引き分け（仕様として選択可能）
- 盤面がループして進行不能になった場合も引き分け扱い（任意）

## 8. 実装向けデータ構造例（非コード）
Board

layer_upper[4][4]

layer_lower[3][3]

CellState = { empty, red, blue }

Phase = { placing, moving }

activePlayer = { red, blue }

piecesRemaining[player] = 4（配置フェーズ中のみ利用）
